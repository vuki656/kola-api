generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DB_PRISMA_URL")
}

model Listing {
    id               String          @id @default(dbgenerated("public.uuid_generate_v4()")) @db.Uuid
    title            String
    year             Int             @db.SmallInt
    odometer         Int
    enginePowerValue Int             @map("engine_power_value")
    enginePowerType  EnginePowerType
    description      String
    price            Decimal         @db.Decimal
    userFk           String          @map("user_fk") @db.Uuid
    makeFk           String          @map("make_fk") @db.Uuid
    modelFk          String          @map("model_fk") @db.Uuid
    engineTypeFk     String          @map("engine_type_fk") @db.Uuid
    createdAt        DateTime        @default(dbgenerated("timezone('utc'::text, now())")) @map("created_at") @db.Timestamp(6)
    updatedAt        DateTime        @map("updated_at") @db.Timestamp(6)
    engineType       EngineType      @relation(fields: [engineTypeFk], references: [id], onUpdate: Restrict, map: "FK_listings__engine_type")
    make             Make            @relation(fields: [makeFk], references: [id], onUpdate: Restrict, map: "FK_listings__makes")
    model            Model           @relation(fields: [modelFk], references: [id], onUpdate: Restrict, map: "FK_listings__models")
    author           User            @relation(fields: [userFk], references: [id], onUpdate: Restrict, map: "FK_listings__users")

    @@map("listings")
}

model User {
    id          String    @id @default(dbgenerated("public.uuid_generate_v4()")) @db.Uuid
    firstName   String    @map("first_name")
    lastName    String    @map("last_name")
    email       String    @unique
    password    String
    phoneNumber String    @map("phone_number") @db.Char(10)
    oib         String    @unique @db.Char(11)
    isAdmin     Boolean   @default(false) @map("is_admin")
    createdAt   DateTime  @default(dbgenerated("timezone('utc'::text, now())")) @map("created_at") @db.Timestamp(6)
    updatedAt   DateTime  @map("updated_at") @db.Timestamp(6)
    listings    Listing[]

    @@map("users")
}

model Make {
    id        String    @id @default(dbgenerated("public.uuid_generate_v4()")) @db.Uuid
    name      String
    createdAt DateTime  @default(dbgenerated("timezone('utc'::text, now())")) @map("created_at") @db.Timestamp(6)
    updatedAt DateTime  @map("updated_at") @db.Timestamp(6)
    listings  Listing[]
    models    Model[]

    @@map("makes")
}

model Model {
    id        String    @id @default(dbgenerated("public.uuid_generate_v4()")) @db.Uuid
    name      String
    makeFk    String    @map("make_fk") @db.Uuid
    createdAt DateTime  @default(dbgenerated("timezone('utc'::text, now())")) @map("created_at") @db.Timestamp(6)
    updatedAt DateTime  @map("updated_at") @db.Timestamp(6)
    listings  Listing[]
    make      Make      @relation(fields: [makeFk], references: [id], onUpdate: Restrict, map: "FK_models__makes")

    @@map("models")
}

model EngineType {
    id        String    @id @default(dbgenerated("public.uuid_generate_v4()")) @db.Uuid
    name      String
    createdAt DateTime  @default(dbgenerated("timezone('utc'::text, now())")) @map("created_at") @db.Timestamp(6)
    updatedAt DateTime  @map("updated_at") @db.Timestamp(6)
    listings  Listing[]

    @@map("engine_types")
}

enum EnginePowerType {
    HP
    KW

    @@map("engine_power_type")
}
